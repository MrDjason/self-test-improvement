# 正则表达式
`hiLucy`匹配`hiLucy`字符串
## 元字符
### 常用元字符及示例
| 元字符 | 含义解释 | 具体示例 |
|:------:|:---------|:---------|
| `\b`   | 表示单词的开头或者结尾 |`\bhi\b`匹配`hi`|
| `\d`   | 匹配一位数字 |`\b0\b\d\d`匹配`0xx`,x为任意数字|
| `\s`   | 匹配任意的空白符，包括空格、制表符、换行符 |`\ba\b\s\bb\b`匹配`a b`、`a  b`|
| `\w`   | 匹配字母或数字或下划线或汉字|`\ba\b\w\bc\b`匹配`abc`、`a1c`、`a_c`|
| `.`    | 匹配换行符`\n`以外的任意字符 |`\n`匹配除换行符以外任意字符|
| `^`    | 匹配字符串的**开始** |`^Hello`匹配“Hello World”中的“Hello”，遇见空格停止|
| `$`    | 匹配字符串的结尾 |`world$`匹配“Hello World”中的“World”，匹配"world hello"则失败|



## 重复
| 字符 | 含义解释 | 具体实例 |
|:----:|:--------|:--------|
|`*`|重复零次或更多次|`\bhi\b.*\bLucy\b`匹配[hi][......][Lucy]|
|`+`|重复一次或更多次|`\d+`匹配一个或更多连续的数字|
|`?`|重复零次或一次|`\b?`可选匹配一个数字|
|`{n}`|重复n次|`\b\w{6}\b`匹配刚好六个字符的单词|
|`{n,}`|重复n次或更多次|`\b\w{6,}\b`匹配六个或更多字符的单词|
|`{n,m}`|重复n到m次|`\b\w{6,8}\b`匹配六个至八个字符的单词|

## 字符转义
- **举例**：若查找`.`或者`*`会出现问题
- **举措**：可通过`\.`或者`\*`进行转义，若查找`\`可通过`\\`转义



## 字符类
- **匹配没有预定义字符集合**：如`[aeiou]`匹配任意英文元音字符，`[.?!]`匹配标点符号
- **轻松定义范围**：如`[0-9]`与`\d`含义完全一致——1位数字，`[a-z0-9A-Z]`只考虑英文等同于`\w`

### 举例`\(?0\d{2}[)-]?\d{8}`
- **`\(?`**：`(`为元字符表示转义，这里`(`表示重复0-1次，可选
- **`0`**：固定搭配数字0
- **`\d{2}`**：匹配数字重复2次
- **`[) -]?`**：匹配`)`、`空格`、`-`，`?`表示重复0-1次，这里表示可选
- **`\d{8}`**：匹配数字重复8次  
- **匹配成功样例**：`(010)12345678`、`010-12345678`、`010 12345678`、`01012345678`


## 分支条件
`\(?0\d{2}[)-]?\d{8}`|可能错误匹配`010)12345678`、`(022-87654321`，所以需要分支条件
|例子|解释含义|
|:---|:---|
|`0\d{2}-\d{8}\|0\d{3}-\d{7}`|匹配010-12345678或0100-1234567|
|`\(0\d{2}\)[- ]?\d{8}\|0\d{2}[- ]?\d{8}`|匹配(010)-x\*8 010 x\*8或者010-x\*8 010 x\*8|
|`\d{5}-\d{4}\|d{5}`|`12345-1234`或者`12345`|

## 分组
重复多个字符可以用小括号来指定**分组**（也叫子表达式），然后就可以指定这个子表达式的重复次数了
### `(\d{1,3}\.){3}\d{1,3}` IP地址匹配表达式
- **`(\d{1,3}\.){3}`**：匹配3位数字加上一个英文句号，重复三次
- **`\d{1,3}`**：再加上一个1到3位数字
- **错配**：它也将匹配256.300.888.999这种不存在的IP地址
### `·`((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)`
- **`2[0-4]\d`**：匹配200-249之间的数字
- **`25[0-5]`**：匹配250-255之间的数字
- **`[01]?\d\d?`**：匹配0-199之间的数字
- **`(2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}`**：匹配一个`0-255`的数字加`.`，重复三次
- **`(2[0-4]\d|25[0-5]|[01]?\d\d?)`**：第四个0-255的数字

## 反义
有时需要查找不属于某个能简单定义的字符类的字符。比如想查找除了数字以外，其它任意字符都行的情况，这时需要用到**反义**
|代码/语法|说明|
|:------:|:----|
|`\W`|匹配任意不是字母，数字，下划线，汉字的字符|
|`\S`|匹配任意不是空白符的字符|
|`\D`|匹配任意非数字的字符|
|`\B`|匹配不是单词开头或结束的位置|
|`[^x]`|匹配除了x以外的任意字符|
|`[^aeiou]`|匹配除了aeiou这几个字母以外的任意字符|

## 后向引用
**后向引用**用于重复搜索前面某个分组匹配的文本，如`\1`代表分组1匹配的文本，匹配这个子表达式的文本就可以在表达式或其它程序中作进一步的处理
- **用法**：用`()`包裹分组,用`\1`调用，让正则在后续位置再次匹配完全相同的内容
- **举例**：`\b(\w+)\b\s+\1\b`
- **`(\w+)`**：分组1,匹配一个单词
- **`\s+`**：匹配1个以上空白符
- **`\1`**：引用分组1捕获的内容

**命名分组引用**：如果分组太多，数字编号容易混淆，可以给分组起名字
- **用法**:用`(?<名称>子表达式)`定义，再用`\k<名称>`引用
- **举例**：`\b(?<Word>\w+)\b\s+\k<Word>\b`
- **`(?<Word>\w+)`**：给分组取名`Word`，用`\w+`匹配并捕获一个单词
- **`\k<Word>`**：引用`Word`分组捕获的内容

### 常用分组语法
|分类|代码/语法|说明|
|:---:|:-------|:---|
|捕获|`(exp)`|匹配exp,并捕获文本到自动命名的组里|
|捕获|`(?<name>exp)`|匹配exp,并捕获文本到名称为name的组里，也可以写成`(?'name'exp)`|
|捕获|`(?:exp)`|匹配exp,不捕获匹配的文本，也不给此分组分配组号|
|零宽断言|`(?=exp)`|匹配exp前面的位置|
|零宽断言|`(?<=exp)`|匹配exp后面的位置|
|零宽断言|`(?!exp)`|匹配后面跟的不是exp的位置|
|零宽断言|`(?<!exp)`|匹配前面不是exp的位置|
|注释|`(?#comment)`|这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读|

## 零宽断言  
零宽断言是一类 “只匹配位置、不消费字符” 的语法，作用类似\b、^、$，但能通过 “断言条件” 精准定位位置。核心是判断当前位置前后是否符合指定规则，不包含规则本身的字符

### 零宽度正预测先行断言：`(?=exp)`
- **用法**：断言自身出现的位置的后面能匹配表达式exp
- **举例**：`\b\w+(?=ing\b)`  
匹配 “以ing结尾的单词的前面部分”  
搜索文本I'm singing while you're dancing.时，会匹配sing和danc

### 零宽度正回顾后发断言：`(?<=exp)`
- **用法**：断言自身出现的位置的前面能匹配表达式exp
- **举例**：`(?<=\bre)\w+\b`  
匹配 “以re开头的单词的后半部分”（排除re）  
搜索文本reading a book时，匹配ading  

## 负向零宽断言
匹配不符合条件的位置

### 零宽度负预测先行断言：`(?!exp)`
- **用法**：断言此位置的后面不能匹配表达式exp
- **举例**：`\b\w*q(?!u)\w*\b`  
匹配 “包含q但q后面不是u的单词”（解决\b\w*q[^u]\w*\b匹配末尾q出错的问题）  
能匹配Iraq、Benq，不匹配queen（q后面是u）  

### 零宽度负回顾后发断言：`(?<!exp)`
- **用法**：断言当前位置的前面不能匹配exp，只定位位置。
- **举例**：`(?<![a-z])\d{7}`  
匹配 “前面不是小写字母的 7 位数字”  
匹配1234567（前面无小写字母）、A1234567（前面是大写A），不匹配a1234567（前面是小写a）  

## 注释
注释用于在正则表达式中添加说明文字，不影响匹配逻辑，提升可读性。
### 行内注释：`(?#comment)`
- **用法**：在正则中插入(?#注释内容)，注释内容会被引擎忽略
- **举例**：`2[0-4]\d`(?#匹配200-249)|`25[0-5]`(?#匹配250-255)|`[01]?\d\d?`(?#匹配0-199) 

## 贪婪与懒惰
当正则包含*、+等重复限定符时，会因 “匹配字符数量的优先级” 分为贪婪模式和懒惰模式。即使是懒惰模式，也会优先匹配最早出现的符合条件的内容

### 贪婪模式(默认)
- **用法**：在保证整个表达式匹配成功的前提下，**尽可能多匹配字符**
- **举例**：`a.*b`匹配`aabab`会匹配到整个字符串`aabab`

### 懒惰模式(加?)

- **用法**：在保证整个表达式匹配成功的前提下，**尽可能少匹配字符**
- **举例**：`a.*?b`匹配`aabab`会匹配到`aab`(第一个a到最近b)和`ab`(第4、5个字符)

### 懒惰限定符
|代码/语法|说明|
|:---:|:---|
|`*?`|重复任意次，但尽可能少重复|
|`+?`|重复1次或更多次，但尽可能少重复|
|`??`|重复0次或1次，但尽可能少重复|
|`{n,m}?`|重复n到m次，但尽可能少重复|
|`{n,}?`|重复n次以上，但尽可能少重复|

## 处理选项
处理选项用于改变正则表达式的匹配规则（如大小写、多行匹配等），不同语言 / 工具的启用方式不同
|名称|说明|
|:---|:---|
|`IgnoreCase(忽略大小写)`|匹配时不区分大小写|
|`Multiline(多行模式)`|更改^和$的含义，使它们分别在任意一行的行首和行尾匹配，而不仅仅在整个字符串的开头和结尾匹配。(在此模式下,$的精确含意是:匹配\n之前的位置以及字符串结束前的位置.)|
|`Singleline(单行模式)`|更改.的含义，使它与每一个字符匹配（包括换行符\n）|
|`IgnorePatternWhitespace(忽略空白)`|忽略表达式中的非转义空白并启用由#标记的注释|
|`ExplicitCapture(显式捕获)`|仅捕获已被显式命名的组|

## 平衡组 / 递归匹配
平衡组用于匹配嵌套结构（如(100*(50+15))、嵌套 HTML 标签），核心是通过 “堆栈” 记录嵌套层级，确保左右符号（如(和)、<和>）数量匹配。
|语法|作用|	
|:---|:---|
|`(?'group')`|把匹配内容命名为group，并压入 “堆栈”（记录嵌套层级）|
|`(?'-group')`|从堆栈中弹出最后压入的group；若堆栈为空，匹配失败。	
|`(?(group)yes\|no)`|若堆栈中存在group，继续匹配yes部分；否则匹配no部分|
|`(?!)`|零宽负向先行断言，无后缀表达式，永远匹配失败（用于强制回溯）|

## 语法
|代码/语法|说明|
|:---|:---|
| 代码/语法 | 说明 |
| :--- | :--- |
| `\a` | 报警字符(打印它的效果是电脑嘀一声) |
| `\b` | 通常是单词分界位置，但如果在字符类里使用代表退格 |
| `\t` | 制表符，Tab |
| `\r` | 回车 |
| `\v` | 竖向制表符 |
| `\f` | 换页符 |
| `\n` | 换行符 |
| `\e`| Escape |
| `\0nn` | ASCII代码中八进制代码为nn的字符 |
| `\xnn` | ASCII代码中十六进制代码为nn的字符 |
| `\unnnn` | Unicode代码中十六进制代码为nnnn的字符 |
| `\cN` | ASCII控制字符。比如\cC代表Ctrl+C |
| `\A` | 字符串开头(类似^，但不受处理多行选项的影响) |
| `\Z` | 字符串结尾或行尾(不受处理多行选项的影响) |
| `\z` | 字符串结尾(类似$，但不受处理多行选项的影响) |
| `\G` | 当前搜索的开头 |
| `\p{name}` | Unicode中命名为name的字符类，例如\p{IsGreek} |
| `(?>exp)` | 贪婪子表达式 |
| `(?<x>-<y>exp)` | 平衡组 |
| `(?im-nsx:exp)` | 在子表达式exp中改变处理选项 |
| `(?im-nsx)` | 为表达式后面的部分改变处理选项 |
| `(?(exp)yes\|no)` | 把exp当作零宽正向先行断言，如果在这个位置能匹配，使用yes作为此组的表达式；否则使用no |
| `(?(exp)yes)` | 同上，只是使用空表达式作为no |
| `(?(name)yes\|no)` | 如果命名为name的组捕获到了内容，使用yes作为表达式；否则使用no |
| `(?(name)yes)` | 同上，只是使用空表达式作为no |